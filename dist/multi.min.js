/*! multi.js 18-02-2024 */

var multi=function(){var e=function(e,t){var n=t.limit;if(n>-1){for(var r=0,i=0;i<e.options.length;i++)e.options[i].selected&&r++;if(r===n){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(i=0;i<e.options.length;i++){(a=e.options[i]).selected||a.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(i=0;i<e.options.length;i++){var a;"false"===(a=e.options[i]).getAttribute("data-origin-disabled")&&a.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,n,a){var l=t.options[n];if(!l.disabled){var s,d,o;l.selected=!l.selected,e(t,a),s="change",d=t,(o=document.createEvent("HTMLEvents")).initEvent(s,!1,!0),d.dispatchEvent(o);var c=r(t,a);i(t,a,c)}};function n(e,t){var n=t.querySelectorAll(".item");if(n)for(var r=0;r<n.length;r++)n[r].classList.remove("hilight")}var r=function(e,t){for(var n=e.wrapper.lists.selected.querySelectorAll(".item"),r=[],i=0;i<n.length;i++)r.push(n[i].getAttribute("data-value"));return r},i=function(e,t,n){e.setAttribute("data-selected-order",JSON.stringify(n))},a=function(e,t){if(e.wrapper.lists.selected.innerHTML="",e.wrapper.lists.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var n=document.createElement("div"),r=document.createElement("div");n.className="header",r.className="header",n.innerText=t.non_selected_header,r.innerText=t.selected_header,e.wrapper.lists.non_selected.appendChild(n),e.wrapper.lists.selected.appendChild(r)}if(e.wrapper.search)var a=e.wrapper.search.value;for(var l,s,d=null,o=null,c=function(e,t){try{return JSON.parse(e.getAttribute("data-selected-order"))}catch(e){return[]}}(e),u=[],p=e.getAttribute("data-multi-hilight"),m=0;m<e.options.length;m++){var h=e.options[m],b=h.value,v=h.textContent||h.innerText,_=document.createElement("li");if(_.tabIndex=0,_.className="item",_.innerText=v,_.setAttribute("role","option"),_.setAttribute("data-value",b),_.setAttribute("multi-index",m),h.disabled&&(_.className+=" disabled"),h.selected){_.className+=" selected";var f=_.cloneNode(!0);p==m&&(f.className+=" hilight"),u.push(f)}if("OPTGROUP"==h.parentNode.nodeName&&h.parentNode!=o){if(o=h.parentNode,(d=document.createElement("div")).className="item-group",h.parentNode.label){var g=document.createElement("span");g.innerHTML=h.parentNode.label,g.className="group-label",d.appendChild(g)}e.wrapper.lists.non_selected.appendChild(d)}h.parentNode==e&&(d=null,o=null),(!a||a&&v.toLowerCase().indexOf(a.toLowerCase())>-1)&&(null!=d?d.appendChild(_):e.wrapper.lists.non_selected.appendChild(_))}for(var w=0;w<c.length;w++)l=c[w],(s=u.find_option_by_value(l))>=0&&(e.wrapper.lists.selected.appendChild(u[s]),u.splice(s,1));for(w=0;w<u.length;w++)e.wrapper.lists.selected.appendChild(u[w]),c.push(u[w].getAttribute("data-value"));if(i(e,t,c),t.hide_empty_groups){var N=document.getElementsByClassName("item-group");for(m=0;m<N.length;m++)N[m].childElementCount<2&&(N[m].style.display="none")}};Array.prototype.find_option_by_value=function(e){for(var t=0;t<this.length;t++)if(this[t].getAttribute("data-value")==e)return t;return-1};return function(l,s){if((s=void 0!==s?s:{}).enable_search=void 0===s.enable_search||s.enable_search,s.search_placeholder=void 0!==s.search_placeholder?s.search_placeholder:"Search...",s.non_selected_header=void 0!==s.non_selected_header?s.non_selected_header:null,s.selected_header=void 0!==s.selected_header?s.selected_header:null,s.limit=void 0!==s.limit?parseInt(s.limit):-1,isNaN(s.limit)&&(s.limit=-1),s.hide_empty_groups=void 0!==s.hide_empty_groups&&s.hide_empty_groups,s.selected_order=Array.isArray(s.selected_order)?s.selected_order:[],s.show_move_buttons=void 0!==s.show_move_buttons&&s.show_move_buttons,null==l.dataset.multijs&&"SELECT"==l.nodeName&&l.multiple){l.style.display="none",l.setAttribute("data-multijs",!0),l.setAttribute("data-selected-order",JSON.stringify(s.selected_order));var d=document.createElement("div");if(d.className="multi-wrapper",s.enable_search){var o=document.createElement("input");o.className="search-input",o.type="text",o.setAttribute("placeholder",s.search_placeholder),o.setAttribute("title",s.search_placeholder),o.addEventListener("input",function(){a(l,s)}),d.appendChild(o),d.search=o}var c=document.createElement("div");c.className="multi-wraplists";var u=document.createElement("ol");u.className="non-selected-wrapper",u.setAttribute("role","listbox");var p=document.createElement("ol");if(p.className="selected-wrapper",p.setAttribute("role","listbox"),d.addEventListener("keypress",function(e){var n=32===e.keyCode||13===e.keyCode,r=e.target.getAttribute("multi-index");r&&n&&(e.preventDefault(),t(l,r,s))}),c.appendChild(u),s.show_move_buttons){var m=document.createElement("div"),h=document.createElement("button"),b=document.createElement("button");m.className="wrapper-center",h.className="btn btn-right",b.className="btn btn-left",h.setAttribute("type","button"),b.setAttribute("type","button"),h.innerHTML=s.button_up_label?s.button_up_label:"→",b.innerHTML=s.button_down_label?s.button_down_label:"←",m.appendChild(h),m.appendChild(b),c.appendChild(m),b.addEventListener("click",function(e){var n=parseInt(l.getAttribute("data-multi-hilight"));if(n>=0){var r=l.options[n];!r.disabled&&r.selected&&t(l,n,s)}})}if(c.appendChild(p),c.non_selected=u,c.selected=p,d.appendChild(c),d.lists=c,l.wrapper=d,l.parentNode.insertBefore(d,l.nextSibling),d.addEventListener("dblclick",function(e){e.target.getAttribute("multi-index")&&t(l,e.target.getAttribute("multi-index"),s)}),d.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&(d.lists.selected.contains(e.target)||d.lists.non_selected.contains(e.target))&&function(e,t,r){var i=t.target.getAttribute("multi-index");e.options[i].disabled||(e.setAttribute("data-multi-hilight",""+i),n(0,e.wrapper.lists.selected),n(0,e.wrapper.lists.non_selected),t.target.className+=" hilight")}(l,e)}),s.selected_updown){var v=document.createElement("div"),_=document.createElement("div"),f=document.createElement("div"),g=document.createElement("button"),w=document.createElement("button");if(v.className="wrapper-low",f.className="controls",_.className="controls",g.className="btn btn-up",w.className="btn btn-down",g.setAttribute("type","button"),w.setAttribute("type","button"),g.innerHTML=s.button_up_label?s.button_up_label:"↑",w.innerHTML=s.button_down_label?s.button_down_label:"↓",f.appendChild(g),f.appendChild(w),v.appendChild(_),s.show_move_buttons){var N=document.createElement("div");N.className="wrapper-center",v.appendChild(N)}v.appendChild(f),d.appendChild(v),g.addEventListener("click",function(e){!function(e,t,n){for(var a=e.wrapper.lists.selected.querySelectorAll(".item"),l=1;l<a.length;l++){var s=a[l];s.classList.contains("hilight")&&e.wrapper.lists.selected.insertBefore(s,a[l-1])}var d=r(e,n);i(e,n,d)}(l,0,s)}),w.addEventListener("click",function(e){!function(e,t,n){for(var a=e.wrapper.lists.selected.querySelectorAll(".item"),l=0;l<a.length-1;l++){var s=a[l];s.classList.contains("hilight")&&e.wrapper.lists.selected.insertBefore(s,a[l+1].nextSibling)}var d=r(e,n);i(e,n,d)}(l,0,s)})}for(var y=0;y<l.options.length;y++){var A=l.options[y];A.setAttribute("data-origin-disabled",A.disabled)}e(l,s),a(l,s),l.addEventListener("change",function(){a(l,s)})}}}(),multi_get_selected_order=function(e){if(e)try{var t=e.getAttribute("data-selected-order");return t?JSON.parse(t):void 0}catch(e){return[]}};"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){if("string"!=typeof t)return settings=void 0!==t?t:{},this.each(function(){var t=e(this);multi(t.get(0),settings)});if("multi_get_selected_order"===t){var n=e(this);if(n.length>1)throw"Method call only supported on a single jQuery object.";return multi_get_selected_order(n.get(0))}}}(jQuery);